import{c as b,d as R}from"./chunk-SHF7GFMJ.js";import{C as i,O as v,R as p,T as L,W as g,Z as h,aa as l,l as d,m as s,p as f,q as u,v as E,wc as m}from"./chunk-U346BHW4.js";var U={error:1,warn:2,info:3,debug:4},c=class a{APP_PREFIX="[HOSPITALSDLGAPP]";minLogLevel;constructor(){this.minLogLevel=m()?"debug":"error"}error(r,t){this.log("error",r,t)}warn(r,t){this.log("warn",r,t)}info(r,t){this.log("info",r,t)}debug(r,t){this.log("debug",r,t)}log(r,t,e){if(this.shouldLog(r)){let o=this.formatMessage(r,t);this.outputLog(r,o,e)}}shouldLog(r){return U[r]<=U[this.minLogLevel]}formatMessage(r,t){let e=new Date().toISOString();return`${this.APP_PREFIX} [${r.toUpperCase()}] ${e} - ${t}`}outputLog(r,t,e){switch(r){case"error":console.error(t,e);break;case"warn":console.warn(t,e);break;case"info":console.info(t,e);break;case"debug":console.debug(t,e);break}}static \u0275fac=function(t){return new(t||a)};static \u0275prov=g({token:a,factory:a.\u0275fac,providedIn:"root"})};var $=new h("API_BASE_URL"),_=new h("API_WS_BASE_URL");var I=class a{http=l(R);baseUrl=l($);baseWsUrl=l(_);logger=l(c);uuid$=this.createUuidStream();getUuid(){return f(this.uuid$)}createUuidStream(){return E(()=>this.http.get(`${this.baseUrl}/id_prefix_api_secret/`)).pipe(L(r=>{this.logger.debug("UUID fetched",r.id_prefix_api_secret)}),u(r=>r.id_prefix_api_secret),i(r=>{let t=this.toHttpErrorResponse(r,"No se pudo cargar el UUID de la API");return this.logger.error("Error fetching UUID",t),s(()=>t)}),v({bufferSize:1,refCount:!1}))}buildUrl(r){return/^https?:\/\//i.test(r)?d(r):this.uuid$.pipe(u(t=>{let e=r.replace(/^\/+|\/+$/g,"");return`${this.baseUrl}/${t}/${e}`}),i(t=>{let e=this.toHttpErrorResponse(t,`Error al construir la URL para ${r}`);return this.logger.error("Error building URL",e),s(()=>e)}))}buildWsUrl(r){return this.uuid$.pipe(u(t=>{let e=r.replace(/^\/+|\/+$/g,"");return`${this.baseWsUrl}/${t}/${e}`}),i(t=>{let e=this.toHttpErrorResponse(t,`Error al construir la URL de WebSocket para ${r}`);return this.logger.error("Error building WebSocket URL",e),s(()=>e)}))}get(r,t){return this.buildUrl(r).pipe(p(e=>this.http.get(e,t)),i(e=>{let o=this.toHttpErrorResponse(e,`Error al obtener datos de ${r}`);return this.logger.error(`Error in GET ${r}`,o),s(()=>o)}))}post(r,t,e){return this.buildUrl(r).pipe(p(o=>this.http.post(o,t,e)),i(o=>{let n=this.toHttpErrorResponse(o,`Error al enviar datos a ${r}`);return this.logger.error(`Error in POST ${r}`,n),s(()=>n)}))}put(r,t,e){return this.buildUrl(r).pipe(p(o=>this.http.put(o,t,e)),i(o=>{let n=this.toHttpErrorResponse(o,`Error al actualizar datos en ${r}`);return this.logger.error(`Error in PUT ${r}`,n),s(()=>n)}))}delete(r,t){return this.buildUrl(r).pipe(p(e=>this.http.delete(e,t)),i(e=>{let o=this.toHttpErrorResponse(e,`Error al eliminar datos en ${r}`);return this.logger.error(`Error in DELETE ${r}`,o),s(()=>o)}))}patch(r,t,e){return this.buildUrl(r).pipe(p(o=>this.http.patch(o,t,e)),i(o=>{let n=this.toHttpErrorResponse(o,`Error al modificar datos en ${r}`);return this.logger.error(`Error in PATCH ${r}`,n),s(()=>n)}))}toHttpErrorResponse(r,t){return r instanceof b?r:new b({error:r,status:typeof r=="object"&&r!==null&&"status"in r?r.status:0,statusText:t})}static \u0275fac=function(t){return new(t||a)};static \u0275prov=g({token:a,factory:a.\u0275fac,providedIn:"root"})};export{c as a,$ as b,_ as c,I as d};
