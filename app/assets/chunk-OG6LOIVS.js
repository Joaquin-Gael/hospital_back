import"./chunk-BYXBJQAS.js";import{a as F}from"./chunk-HP6QVOZ5.js";import{a as V}from"./chunk-7FZOI23T.js";import"./chunk-QMYIRM4F.js";import{a as D}from"./chunk-QPGYGB2T.js";import{a as j}from"./chunk-2DW5HR5M.js";import"./chunk-D7I6PEHK.js";import"./chunk-PC5HHMPZ.js";import"./chunk-LILA3PAH.js";import"./chunk-TYX6CIEY.js";import{a as T}from"./chunk-J2GLTX2R.js";import{d as I,e as z,h as N}from"./chunk-RASRAAIY.js";import"./chunk-JUPDXIAV.js";import"./chunk-GGYCCLGV.js";import{$b as i,Eb as g,Jb as t,Kb as n,Lb as E,Ob as v,Qb as C,Rb as p,S as x,Wa as w,Yc as k,_a as a,aa as d,ac as _,bc as c,cc as b,f as M,ia as u,ic as P,ja as h,ka as O,kb as S,la as y,pb as m,yb as f}from"./chunk-VYPP3LKO.js";import"./chunk-4CLCTAJ7.js";var R=()=>["/user_panel/change-password"],U=()=>["/user_panel/edit-profile"];function $(o,r){o&1&&(t(0,"div",2)(1,"i",3),i(2,"hourglass_empty"),n(),t(3,"span"),i(4,"Cargando perfil..."),n()())}function A(o,r){if(o&1&&(t(0,"div",4)(1,"span"),i(2),n()()),o&2){let e=p(2);a(2),_(e.error)}}function B(o,r){if(o&1){let e=v();t(0,"img",22),C("error",function(){u(e);let s=p(4);return h(s.onImageError())}),n()}if(o&2){let e=p(4);f("src",e.user.img_profile,w)("alt","Avatar de "+e.user.username)}}function G(o,r){if(o&1&&(t(0,"div",9)(1,"span",23),i(2),n()()),o&2){let e=p(4);a(2),c(" ",e.getInitials(e.user.username)," ")}}function q(o,r){if(o&1){let e=v();t(0,"div",6)(1,"div",7),m(2,B,1,2,"img",8)(3,G,3,1,"div",9),n(),t(4,"div")(5,"h2",10),i(6),n(),t(7,"p",11),i(8),n()()(),t(9,"div",12)(10,"div",13)(11,"h3",14),i(12,"Informaci\xF3n Personal"),n(),t(13,"div",15)(14,"div",16)(15,"span",17),i(16,"Nombre Completo"),n(),t(17,"p",18),i(18),n()(),t(19,"div",16)(20,"span",17),i(21,"Tipo de Sangre"),n(),t(22,"p",18),i(23),n()(),t(24,"div",16)(25,"span",17),i(26,"Correo Electr\xF3nico"),n(),t(27,"p",18),i(28),n()(),t(29,"div",16)(30,"span",17),i(31,"Tel\xE9fono"),n(),t(32,"p",18),i(33),n()()()(),t(34,"div",13)(35,"h3",14),i(36,"Informaci\xF3n Adicional"),n(),t(37,"div",15)(38,"div",16)(39,"span",17),i(40,"Direcci\xF3n"),n(),t(41,"p",18),i(42),n()(),t(43,"div",16)(44,"span",17),i(45,"Obra Social"),n(),t(46,"p",18),i(47),n()(),t(48,"div",16)(49,"span",17),i(50,"\xDAltima Visita"),n(),t(51,"p",18),i(52),n()()()()(),t(53,"div",19)(54,"button",20),C("click",function(){u(e);let s=p(3);return h(s.onChangePassword())}),i(55," Cambiar Contrase\xF1a "),n(),t(56,"button",21),i(57," Editar Perfil "),n()()}if(o&2){let e=p(3);a(2),g(e.user.img_profile?2:3),a(4),b(" ",e.user.first_name||"No disponible"," ",e.user.last_name||""," "),a(2),c("DNI: ",e.user.dni||"No disponible",""),a(10),b(" ",e.user.first_name||"No disponible"," ",e.user.last_name||""," "),a(5),c(" ",e.user.blood_type||"No disponible"," "),a(5),_(e.user.email||"No disponible"),a(5),c(" ",e.user.telephone||"No disponible"," "),a(9),c(" ",e.user.address||"No disponible"," "),a(5),_(e.healthInsurance),a(5),_(e.formatDate(e.lastVisit)),a(2),f("routerLink",P(14,R)),a(2),f("routerLink",P(15,U))}}function J(o,r){o&1&&(t(0,"div",5)(1,"div",24),O(),t(2,"svg",25),E(3,"path",26),n()(),y(),t(4,"h2"),i(5,"No hay datos de perfil"),n(),t(6,"p"),i(7,"No se encontraron datos para mostrar. Por favor, intenta de nuevo."),n()())}function K(o,r){if(o&1&&m(0,q,58,16)(1,J,8,0,"div",5),o&2){let e=p(2);g(e.user?0:1)}}function Q(o,r){if(o&1&&m(0,A,3,1,"div",4)(1,K,2,1),o&2){let e=p();g(e.error?0:1)}}var H=class o{authService=d(D);healthInsuranceService=d(V);appointmentService=d(F);logger=d(T);router=d(I);user=null;healthInsurance="No disponible";lastVisit=null;error=null;loading=!0;destroy$=new M;notificationService=d(j);ngOnInit(){if(!this.authService.isLoggedIn()){this.logger.info("Usuario no autenticado, redirigiendo a /login"),this.router.navigate(["/login"]);return}this.authService.getUser().pipe(x(this.destroy$)).subscribe({next:r=>{if(!r){this.error="No se encontraron datos del usuario",this.logger.error("No user data found"),this.router.navigate(["/login"]);return}this.user=r,this.loading=!1,this.loadHealthInsurance(r.health_insurance[0]),this.loadLastVisit(r.id)},error:r=>{this.error="Error al cargar los datos del usuario",this.loading=!1,this.logger.error("Failed to load user",r),this.router.navigate(["/login"])}})}loadHealthInsurance(r){if(!r){this.healthInsurance="No disponible";return}this.healthInsuranceService.getById(r).pipe(x(this.destroy$)).subscribe({next:e=>{this.healthInsurance=e?`${e.name} (${e.discount}% descuento)`:"No disponible"},error:e=>{this.logger.error("Failed to load health insurance",e),this.healthInsurance="No disponible"}})}loadLastVisit(r){this.appointmentService.getTurnsByUserId(r).pipe(x(this.destroy$)).subscribe({next:e=>{let l=e.filter(s=>s.state==="finished").sort((s,L)=>new Date(L.date).getTime()-new Date(s.date).getTime());this.lastVisit=l.length>0?new Date(l[0].date):null},error:e=>{this.logger.error("Failed to load last visit",e),this.lastVisit=null}})}formatDate(r){return r?r.toLocaleDateString("es-AR",{day:"2-digit",month:"short",year:"numeric"}):"No registrada"}getInitials(r){if(!r||r==="No disponible")return"ND";let e=r.trim().split(" ").filter(l=>l.length>0);return e.length===0?"ND":e.length===1?e[0].substring(0,2).toUpperCase():e.slice(0,2).map(l=>l.charAt(0).toUpperCase()).join("")}onEditProfile(){this.router.navigate(["/user_panel/edit-profile"])}onChangePassword(){this.router.navigate(["/user_panel/change-password"])}onImageError(){this.user&&(this.user.img_profile=null)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=S({type:o,selectors:[["app-profile"]],decls:4,vars:1,consts:[[1,"profile"],[1,"profile__card"],[1,"loading-spinner"],[1,"material-icons","loading-icon"],[1,"error"],[1,"empty-state"],[1,"profile__header"],[1,"profile__avatar"],[1,"profile__avatar-initials",3,"src","alt"],[1,"sidebar__avatar-placeholder"],[1,"profile__name"],[1,"profile__id"],[1,"profile__body"],[1,"profile__section"],[1,"profile__section-title"],[1,"profile__grid"],[1,"profile__field"],[1,"profile__label"],[1,"profile__value"],[1,"profile__footer"],[1,"btn","btn--outline",3,"click","routerLink"],[1,"btn","btn--primary",3,"routerLink"],[1,"profile__avatar-initials",3,"error","src","alt"],[1,"profile__avatar-initials"],[1,"empty-state__icon"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","none","stroke","currentColor",1,"icon"],["stroke-linecap","round","stroke-linejoin","round","d","M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"]],template:function(e,l){e&1&&(t(0,"section",0)(1,"div",1),m(2,$,5,0,"div",2)(3,Q,2,1),n()()),e&2&&(a(2),g(l.loading?2:3))},dependencies:[k,N,z],styles:["[_ngcontent-%COMP%]:root{--user-panel-surface: var(--surface-primary);--user-panel-surface-alt: color-mix(in srgb, var(--surface-primary) 92%, var(--surface-secondary) 8%);--user-panel-surface-muted: color-mix(in srgb, var(--surface-primary) 85%, var(--surface-secondary) 15%);--user-panel-border: var(--border-subtle);--user-panel-border-strong: var(--border-strong);--user-panel-text: var(--text-primary);--user-panel-text-muted: var(--text-secondary);--user-panel-text-soft: var(--text-muted);--user-panel-primary: var(--color-primary);--user-panel-primary-hover: var(--color-primary-hover);--user-panel-primary-dark: var(--color-primary-dark);--user-panel-primary-soft: color-mix(in srgb, var(--color-primary) 12%, transparent 88%);--user-panel-layer-soft: color-mix(in srgb, var(--color-primary) 10%, transparent 90%);--user-panel-layer-strong: color-mix(in srgb, var(--color-primary) 18%, transparent 82%);--user-panel-success: var(--color-success);--user-panel-success-soft: color-mix(in srgb, var(--color-success) 16%, transparent 84%);--user-panel-warning: var(--color-warning);--user-panel-warning-soft: color-mix(in srgb, var(--color-warning) 16%, transparent 84%);--user-panel-danger: var(--color-error);--user-panel-danger-soft: color-mix(in srgb, var(--color-error) 16%, transparent 84%);--user-panel-info: var(--color-info);--user-panel-info-soft: color-mix(in srgb, var(--color-info) 16%, transparent 84%);--user-panel-shadow-sm: var(--shadow-sm);--user-panel-shadow-md: var(--shadow-md);--user-panel-shadow-lg: var(--shadow-lg);--user-panel-focus-ring: var(--focus-ring);--user-panel-overlay: var(--surface-backdrop);--user-panel-navbar-hover: color-mix(in srgb, var(--color-primary) 12%, transparent 88%);--user-panel-navbar-active: color-mix(in srgb, var(--color-primary) 18%, transparent 82%);--user-panel-navbar-border: color-mix(in srgb, var(--color-primary) 25%, transparent 75%);--user-panel-navbar-gradient: var(--gradient-primary);--user-panel-navbar-text: var(--text-primary);--user-panel-footer-shadow: var(--shadow-sm);--user-panel-footer-button-shadow: color-mix(in srgb, var(--color-primary) 20%, transparent 80%)}[data-theme=dark][_ngcontent-%COMP%]{--user-panel-surface-alt: color-mix(in srgb, var(--surface-primary) 88%, var(--surface-secondary) 12%);--user-panel-surface-muted: color-mix(in srgb, var(--surface-primary) 70%, var(--surface-secondary) 30%);--user-panel-navbar-hover: color-mix(in srgb, var(--color-primary) 20%, transparent 80%);--user-panel-navbar-active: color-mix(in srgb, var(--color-primary) 28%, transparent 72%);--user-panel-footer-shadow: var(--shadow-md)}.icon[_ngcontent-%COMP%]{width:20px;height:20px;stroke-width:2}.btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:10px 16px;border-radius:var(--border-radius-sm);font-weight:500;font-size:14px;cursor:pointer;transition:var(--transition-smooth);border:none;color:var(--text-white)}.btn--primary[_ngcontent-%COMP%]{color:var(--text-white);background:linear-gradient(135deg,var(--user-panel-primary) 0%,var(--user-panel-primary-dark) 100%)}.btn--outline[_ngcontent-%COMP%]{background-color:transparent;color:var(--user-panel-text);border:1px solid var(--user-panel-border)}.btn--outline[_ngcontent-%COMP%]:hover{background-color:var(--user-panel-surface)}.btn--danger[_ngcontent-%COMP%]{background-color:var(--user-panel-danger);color:var(--text-white)}.btn--danger[_ngcontent-%COMP%]:hover{background-color:color-mix(in srgb,var(--user-panel-danger) 95%,black 5%)}.btn--sm[_ngcontent-%COMP%]{padding:6px 12px;font-size:12px}.btn[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:16px;height:16px}.btn-icon[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:50%;background-color:transparent;color:var(--user-panel-text-muted);border:none;cursor:pointer;transition:var(--transition-smooth)}.btn-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-start;gap:8px}.btn-icon[_ngcontent-%COMP%]:hover{background-color:var(--user-panel-surface);color:var(--user-panel-primary)}.btn-icon[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:18px;height:18px}.empty-state[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;padding:60px 20px;text-align:center}.empty-state__icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:80px;height:80px;border-radius:50%;background-color:var(--user-panel-layer-soft);color:var(--user-panel-primary);margin-bottom:24px}.empty-state__icon[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:40px;height:40px}.empty-state[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:20px;font-weight:600;margin:0 0 8px;color:var(--user-panel-text)}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:var(--user-panel-text-muted);margin:0 0 24px}.profile[_ngcontent-%COMP%]{margin-top:32px}.profile__card[_ngcontent-%COMP%]{overflow:hidden;background-color:var(--user-panel-surface-alt);border-radius:var(--border-radius-md);box-shadow:var(--user-panel-shadow-sm);border:1px solid var(--user-panel-border);transition:var(--transition-smooth)}.profile__header[_ngcontent-%COMP%]{padding:24px;background-color:var(--user-panel-layer-soft);border-bottom:1px solid var(--user-panel-border)}.profile__header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-start;gap:24px}@media (max-width: 479px){.profile__header[_ngcontent-%COMP%]{flex-direction:column;text-align:center;gap:16px;padding:20px 16px}}@media (min-width: 480px) and (max-width: 767px){.profile__header[_ngcontent-%COMP%]{gap:20px;padding:20px}}.profile__avatar[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%;background:linear-gradient(135deg,#11a4d4,#2bbdee);display:flex;align-items:center;justify-content:center;flex-shrink:0;overflow:hidden}.profile__avatar[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#fff;font-size:48px;width:48px;height:48px}.profile__avatar-img[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:50%;object-fit:cover}.profile__avatar-initials[_ngcontent-%COMP%]{color:var(--text-white);font-size:36px;font-weight:600;text-transform:uppercase}@media (max-width: 479px){.profile__avatar[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;background:linear-gradient(135deg,#11a4d4,#2bbdee);display:flex;align-items:center;justify-content:center;flex-shrink:0;overflow:hidden}.profile__avatar[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#fff;font-size:24px;width:24px;height:24px}.profile__avatar-initials[_ngcontent-%COMP%]{font-size:16px}}.profile__name[_ngcontent-%COMP%]{font-size:24px;font-weight:600;margin:0 0 4px;color:var(--user-panel-text)}@media (max-width: 479px){.profile__name[_ngcontent-%COMP%]{font-size:20px}}@media (min-width: 480px) and (max-width: 767px){.profile__name[_ngcontent-%COMP%]{font-size:22px}}.profile__id[_ngcontent-%COMP%]{font-size:14px;color:var(--user-panel-text-muted);margin:0}@media (max-width: 479px){.profile__id[_ngcontent-%COMP%]{font-size:13px}}.profile__body[_ngcontent-%COMP%]{padding:24px}@media (max-width: 479px){.profile__body[_ngcontent-%COMP%]{padding:16px}}@media (min-width: 480px) and (max-width: 767px){.profile__body[_ngcontent-%COMP%]{padding:20px}}.profile__section[_ngcontent-%COMP%]{margin-bottom:32px}.profile__section[_ngcontent-%COMP%]:last-child{margin-bottom:0}@media (max-width: 479px){.profile__section[_ngcontent-%COMP%]{margin-bottom:24px}}.profile__section-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600;margin:0 0 16px;color:var(--user-panel-text);padding-bottom:8px;border-bottom:1px solid var(--user-panel-border)}@media (max-width: 479px){.profile__section-title[_ngcontent-%COMP%]{font-size:16px;margin-bottom:12px}}.profile__grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:24px}@media (max-width: 479px){.profile__grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:18px}}@media (min-width: 480px) and (max-width: 767px){.profile__grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(200px,1fr))}}@media (max-width: 479px){.profile__grid[_ngcontent-%COMP%]{gap:16px}}.profile__field[_ngcontent-%COMP%]{margin-bottom:8px}@media (max-width: 479px){.profile__field[_ngcontent-%COMP%]{margin-bottom:6px}}.profile__label[_ngcontent-%COMP%]{display:block;font-size:12px;font-weight:500;color:var(--user-panel-text-muted);margin-bottom:4px;text-transform:uppercase;letter-spacing:.5px}@media (max-width: 479px){.profile__label[_ngcontent-%COMP%]{font-size:11px}}.profile__value[_ngcontent-%COMP%]{font-size:14px;color:var(--user-panel-text);margin:0;word-break:break-word}@media (max-width: 479px){.profile__value[_ngcontent-%COMP%]{font-size:13px}}.profile__value--empty[_ngcontent-%COMP%]{color:var(--user-panel-text-soft);font-style:italic}.profile__footer[_ngcontent-%COMP%]{padding:16px 24px;border-top:1px solid var(--user-panel-border)}.profile__footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end;gap:12px}@media (max-width: 479px){.profile__footer[_ngcontent-%COMP%]{padding:12px 16px;flex-direction:column;gap:8px}}@media (min-width: 480px) and (max-width: 767px){.profile__footer[_ngcontent-%COMP%]{padding:14px 20px}}.profile__contact-info[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-start;gap:8px}.profile__contact-info[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{color:var(--user-panel-text-soft);width:16px;height:16px;flex-shrink:0}@media (max-width: 479px){.profile__contact-info[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:14px;height:14px}}.profile__verified[_ngcontent-%COMP%]{color:var(--user-panel-success);font-size:12px;font-weight:500}.profile__verified[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-start;gap:6px}.profile__verified[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:14px;height:14px}@media (max-width: 479px){.profile__verified[_ngcontent-%COMP%]{font-size:11px}.profile__verified[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:12px;height:12px}}.profile__unverified[_ngcontent-%COMP%]{color:var(--user-panel-warning);font-size:12px;font-weight:500}.profile__unverified[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-start;gap:6px}.profile__unverified[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:14px;height:14px}@media (max-width: 479px){.profile__unverified[_ngcontent-%COMP%]{font-size:11px}.profile__unverified[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:12px;height:12px}}.profile[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{color:var(--user-panel-danger);text-align:center;padding:1rem;font-size:1rem}.profile[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:var(--user-panel-text)}.profile[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]{display:flex;flex-direction:column}.profile[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   .loading-icon[_ngcontent-%COMP%]{font-size:2rem;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-bottom:.5rem}.profile[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{padding:60px 20px;text-align:center;background-color:var(--user-panel-surface);border-radius:var(--border-radius-md);box-shadow:var(--user-panel-shadow-sm);display:flex;align-items:center;justify-content:center}.profile[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column}@media (max-width: 479px){.profile[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{padding:40px 16px}}.profile[_ngcontent-%COMP%]   .empty-state__icon[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%;background:linear-gradient(135deg,var(--user-panel-primary) 0%,var(--user-panel-primary-dark) 100%);color:var(--user-panel-primary);margin-bottom:24px;display:flex;align-items:center;justify-content:center}.profile[_ngcontent-%COMP%]   .empty-state__icon[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:40px;height:40px}@media (max-width: 479px){.profile[_ngcontent-%COMP%]   .empty-state__icon[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:32px;height:32px}}@media (max-width: 479px){.profile[_ngcontent-%COMP%]   .empty-state__icon[_ngcontent-%COMP%]{width:64px;height:64px;margin-bottom:16px}}.profile[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:20px;font-weight:600;margin:0 0 8px;color:var(--user-panel-text)}@media (max-width: 479px){.profile[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px}}.profile[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:var(--user-panel-text-muted);margin:0 0 24px}@media (max-width: 479px){.profile[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:13px;margin-bottom:16px}}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"]})};export{H as ProfileComponent};
