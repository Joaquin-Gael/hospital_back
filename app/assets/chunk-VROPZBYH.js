import{a as H}from"./chunk-GEOERSQH.js";import{a as k}from"./chunk-FG3VCKV6.js";import{a as E}from"./chunk-SLWJMPZV.js";import"./chunk-2KUBWO5M.js";import{a as A}from"./chunk-4W6XZAEZ.js";import"./chunk-LZ2CXPXV.js";import"./chunk-M3FKVPZN.js";import{a as b}from"./chunk-3F3ZFDNX.js";import{d as F,h as j}from"./chunk-7KU7TUXL.js";import"./chunk-AT6ZLWLU.js";import"./chunk-SHF7GFMJ.js";import{c as R,e as x,f as q,g as G,k as Y,n as B,o as X,u as Z,w as J}from"./chunk-CXCZTUTO.js";import{$a as a,Ab as $,Cb as h,Fb as f,G as T,I as U,Kb as o,Lb as i,Mb as d,R as L,Rb as g,S as O,Sb as C,W as V,Zc as S,aa as c,ac as s,cc as w,f as M,lb as y,m as I,qb as _,ta as N,zb as m}from"./chunk-U346BHW4.js";import"./chunk-4CLCTAJ7.js";var P=class r{logger=c(b);userService=c(H);authService=c(k);changePassword(n,e){return this.logger.info("Cambiando contrase\xF1a"),this.authService.getUser().pipe(T(1),L(t=>{if(!t?.id)return this.logger.error("No se pudo obtener el ID del usuario autenticado para el cambio de contrase\xF1a"),I(()=>new Error("No se pudo obtener el usuario autenticado"));let l={current_password:n,new_password:e};return this.userService.changePassword(t.id,l)}))}calculatePasswordStrength(n){let t=[{test:/[a-z]/.test(n),points:1},{test:/[A-Z]/.test(n),points:1},{test:/[0-9]/.test(n),points:1},{test:/[!@#$%^&*(),.?":{}|<>]/.test(n),points:1},{test:n.length>=8,points:1},{test:n.length>=12,points:1},{test:!/(.)\1{2,}/.test(n),points:1},{test:!/123|abc|qwe|password/i.test(n),points:1}].reduce((l,p)=>l+(p.test?p.points:0),0);return t<=2?{level:"weak",percentage:25,text:"Muy d\xE9bil"}:t<=4?{level:"fair",percentage:50,text:"D\xE9bil"}:t<=6?{level:"good",percentage:75,text:"Buena"}:{level:"strong",percentage:100,text:"Muy segura"}}passwordStrengthValidator(n){let e=n.value;if(!e)return null;let t=/[A-Z]/.test(e),l=/[a-z]/.test(e),p=/[0-9]/.test(e),v=/[!@#$%^&*(),.?":{}|<>]/.test(e),u=e.length>=8;return[t,l,p,v,u].filter(W=>W).length<3?{weakPassword:!0}:null}passwordMatchValidator(n){let e=n.get("newPassword")?.value,t=n.get("confirmPassword")?.value;return e&&t&&e!==t?{passwordMismatch:!0}:null}static \u0275fac=function(e){return new(e||r)};static \u0275prov=V({token:r,factory:r.\u0275fac,providedIn:"root"})};function te(r,n){if(r&1&&(o(0,"div",19),d(1,"i",33),s(2),i()),r&2){let e=C();a(2),w(" ",e.getFieldError("currentPassword")," ")}}function ne(r,n){r&1&&(d(0,"i",31),s(1," Cargando... "))}function oe(r,n){r&1&&(d(0,"i",34),s(1," \xBFNo recuerdas tu contrase\xF1a actual? "))}function re(r,n){if(r&1&&(o(0,"div",19),d(1,"i",33),s(2),i()),r&2){let e=C();a(2),w(" ",e.getFieldError("newPassword")," ")}}function ie(r,n){if(r&1&&(o(0,"div",24)(1,"div",35),s(2,"Seguridad de la contrase\xF1a:"),i(),o(3,"div",36),d(4,"div",37),i(),o(5,"span",38),s(6),i()()),r&2){let e=C();a(4),h("password-strength__fill--"+e.passwordStrength.level),$("width",e.passwordStrength.percentage,"%"),a(),h("password-strength__text--"+e.passwordStrength.level),a(),w(" ",e.passwordStrength.text," ")}}function ae(r,n){if(r&1&&(o(0,"div",19),d(1,"i",33),s(2),i()),r&2){let e=C();a(2),w(" ",e.getFieldError("confirmPassword")," ")}}function se(r,n){r&1&&(o(0,"div",19),d(1,"i",33),s(2," Las contrase\xF1as no coinciden "),i())}function de(r,n){r&1&&d(0,"i",31)}function le(r,n){r&1&&d(0,"i",32)}var z=class r{fb=c(Z);passwordService=c(P);router=c(F);authService=c(k);storage=c(A);logger=c(b);notificationService=c(E);destroy$=new M;isSubmitting=!1;formSubmit=new N;formCancel=new N;changePasswordForm;showCurrentPassword=!1;showNewPassword=!1;showConfirmPassword=!1;isLoadingUserData=!1;passwordStrength={level:"weak",percentage:0,text:"Muy d\xE9bil"};ngOnInit(){this.initializeForm()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}initializeForm(){this.changePasswordForm=this.fb.group({currentPassword:["",[x.required]],newPassword:["",[x.required,x.minLength(8),this.passwordService.passwordStrengthValidator]],confirmPassword:["",[x.required]]},{validators:this.passwordService.passwordMatchValidator}),this.changePasswordForm.get("newPassword")?.valueChanges.subscribe(n=>{n?this.passwordStrength=this.passwordService.calculatePasswordStrength(n):this.passwordStrength={level:"weak",percentage:0,text:"Muy d\xE9bil"}})}toggleCurrentPasswordVisibility(){this.showCurrentPassword=!this.showCurrentPassword}toggleNewPasswordVisibility(){this.showNewPassword=!this.showNewPassword}toggleConfirmPasswordVisibility(){this.showConfirmPassword=!this.showConfirmPassword}onSubmit(){if(this.changePasswordForm.valid&&!this.isSubmitting){let n={currentPassword:this.changePasswordForm.get("currentPassword").value,newPassword:this.changePasswordForm.get("newPassword").value};this.formSubmit.emit(n)}else Object.keys(this.changePasswordForm.controls).forEach(n=>{this.changePasswordForm.get(n)?.markAsTouched()})}onCancel(){this.router.navigate(["user_panel/profile"])}onForgotPassword(){if(!this.authService.isLoggedIn()){this.logger.warn("Usuario no autenticado intentando acceder al reset de contrase\xF1a"),this.router.navigate(["/login"]);return}this.isLoadingUserData=!0,this.authService.getUser().pipe(O(this.destroy$)).subscribe({next:n=>{if(this.isLoadingUserData=!1,!n){this.logger.error("No se pudieron obtener los datos del usuario autenticado"),this.notificationService.error("Error al obtener datos del usuario. Por favor, inicia sesi\xF3n nuevamente.",{duration:4e3}),this.router.navigate(["/login"]);return}if(!n.username){this.logger.error("Usuario sin email encontrado"),this.notificationService.error("No se encontr\xF3 un email asociado a tu cuenta.",{duration:4e3});return}let e={email:n.username,phone:n.telephone||null,hasEmail:!0,hasPhone:!!n.telephone};this.storage.setItem("reset_user_profile",JSON.stringify(e)),this.logger.info("Datos de usuario guardados para reset de contrase\xF1a",{hasEmail:e.hasEmail,hasPhone:e.hasPhone,email:this.maskEmailForLog(e.email)});let t=[];e.hasEmail&&t.push("correo electr\xF3nico"),e.hasPhone&&t.push("tel\xE9fono"),this.notificationService.success(`Redirigiendo al restablecimiento de contrase\xF1a. Podr\xE1s usar: ${t.join(" o ")}.`,{duration:3e3}),setTimeout(()=>{this.router.navigate(["/user_panel/recovery-password"])},1e3)},error:n=>{this.isLoadingUserData=!1,this.logger.error("Error al obtener datos del usuario para reset",n),this.notificationService.error("Error al obtener los datos de tu cuenta. Int\xE9ntalo nuevamente.",{duration:4e3})}})}maskEmailForLog(n){let[e,t]=n.split("@");return e.length<=2?`${e}***@${t}`:`${e.substring(0,2)}***@${t}`}getFieldError(n){let e=this.changePasswordForm.get(n);if(e?.errors){if(e.errors.required)return"Este campo es obligatorio";if(e.errors.minlength)return`M\xEDnimo ${e.errors.minlength.requiredLength} caracteres`;if(e.errors.weakPassword)return"La contrase\xF1a debe ser m\xE1s segura"}return""}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=y({type:r,selectors:[["app-change-password-form"]],inputs:{isSubmitting:"isSubmitting"},outputs:{formSubmit:"formSubmit",formCancel:"formCancel"},decls:68,vars:21,consts:[[1,"change-password-form"],[1,"change-password-form__header"],[1,"change-password-form__title"],[1,"fas","fa-key","change-password-form__title-icon"],[1,"change-password-form__description"],["novalidate","",1,"change-password-form__form",3,"ngSubmit","formGroup"],[1,"security-notice"],[1,"security-notice__icon"],[1,"fas","fa-shield-alt"],[1,"security-notice__content"],[1,"security-notice__title"],[1,"security-notice__list"],[1,"change-password-form__fields"],[1,"form-field"],["for","currentPassword",1,"form-field__label"],[1,"form-field__required"],[1,"form-field__input-container"],["id","currentPassword","formControlName","currentPassword","placeholder","Ingresa tu contrase\xF1a actual",1,"form-field__input",3,"type"],["type","button",1,"form-field__toggle-password",3,"click"],[1,"form-field__error"],[1,"form-field__help"],["type","button",1,"forgot-password-link",3,"click","disabled"],["for","newPassword",1,"form-field__label"],["id","newPassword","formControlName","newPassword","placeholder","Ingresa tu nueva contrase\xF1a",1,"form-field__input",3,"type"],[1,"password-strength"],["for","confirmPassword",1,"form-field__label"],["id","confirmPassword","formControlName","confirmPassword","placeholder","Confirma tu nueva contrase\xF1a",1,"form-field__input",3,"type"],[1,"change-password-form__actions"],["type","button",1,"change-password-form__button","change-password-form__button--secondary",3,"click","disabled"],[1,"fas","fa-times"],["type","submit",1,"change-password-form__button","change-password-form__button--primary",3,"disabled"],[1,"fas","fa-spinner","fa-spin"],[1,"fas","fa-key"],[1,"fas","fa-exclamation-triangle"],[1,"fas","fa-question-circle"],[1,"password-strength__label"],[1,"password-strength__bar"],[1,"password-strength__fill"],[1,"password-strength__text"]],template:function(e,t){if(e&1&&(o(0,"div",0)(1,"div",1)(2,"h2",2),d(3,"i",3),s(4," Cambiar Contrase\xF1a "),i(),o(5,"p",4),s(6," Actualiza tu contrase\xF1a para mantener tu cuenta segura "),i()(),o(7,"form",5),g("ngSubmit",function(){return t.onSubmit()}),o(8,"div",6)(9,"div",7),d(10,"i",8),i(),o(11,"div",9)(12,"h4",10),s(13,"Recomendaciones de seguridad"),i(),o(14,"ul",11)(15,"li"),s(16,"Usa al menos 8 caracteres"),i(),o(17,"li"),s(18,"Incluye may\xFAsculas, min\xFAsculas y n\xFAmeros"),i(),o(19,"li"),s(20,"Agrega s\xEDmbolos especiales (!@#$%^&*)"),i(),o(21,"li"),s(22,"No uses informaci\xF3n personal"),i()()()(),o(23,"div",12)(24,"div",13)(25,"label",14),s(26," Contrase\xF1a actual "),o(27,"span",15),s(28,"*"),i()(),o(29,"div",16),d(30,"input",17),o(31,"button",18),g("click",function(){return t.toggleCurrentPasswordVisibility()}),d(32,"i"),i()(),_(33,te,3,1,"div",19),o(34,"div",20)(35,"button",21),g("click",function(){return t.onForgotPassword()}),_(36,ne,2,0)(37,oe,2,0),i()()(),o(38,"div",13)(39,"label",22),s(40," Nueva contrase\xF1a "),o(41,"span",15),s(42,"*"),i()(),o(43,"div",16),d(44,"input",23),o(45,"button",18),g("click",function(){return t.toggleNewPasswordVisibility()}),d(46,"i"),i()(),_(47,re,3,1,"div",19)(48,ie,7,7,"div",24),i(),o(49,"div",13)(50,"label",25),s(51," Confirmar nueva contrase\xF1a "),o(52,"span",15),s(53,"*"),i()(),o(54,"div",16),d(55,"input",26),o(56,"button",18),g("click",function(){return t.toggleConfirmPasswordVisibility()}),d(57,"i"),i()(),_(58,ae,3,1,"div",19)(59,se,3,0,"div",19),i()(),o(60,"div",27)(61,"button",28),g("click",function(){return t.onCancel()}),d(62,"i",29),s(63," Cancelar "),i(),o(64,"button",30),_(65,de,1,0,"i",31)(66,le,1,0,"i",32),s(67),i()()()()),e&2){let l,p,v,u,D;a(7),m("formGroup",t.changePasswordForm),a(23),m("type",t.showCurrentPassword?"text":"password"),a(2),h(t.showCurrentPassword?"fas fa-eye-slash":"fas fa-eye"),a(),f((l=t.changePasswordForm.get("currentPassword"))!=null&&l.invalid&&((l=t.changePasswordForm.get("currentPassword"))!=null&&l.touched)?33:-1),a(2),m("disabled",t.isLoadingUserData),a(),f(t.isLoadingUserData?36:37),a(8),m("type",t.showNewPassword?"text":"password"),a(2),h(t.showNewPassword?"fas fa-eye-slash":"fas fa-eye"),a(),f((p=t.changePasswordForm.get("newPassword"))!=null&&p.invalid&&((p=t.changePasswordForm.get("newPassword"))!=null&&p.touched)?47:-1),a(),f((v=t.changePasswordForm.get("newPassword"))!=null&&v.value?48:-1),a(7),m("type",t.showConfirmPassword?"text":"password"),a(2),h(t.showConfirmPassword?"fas fa-eye-slash":"fas fa-eye"),a(),f((u=t.changePasswordForm.get("confirmPassword"))!=null&&u.invalid&&((u=t.changePasswordForm.get("confirmPassword"))!=null&&u.touched)?58:-1),a(),f(t.changePasswordForm.errors!=null&&t.changePasswordForm.errors.passwordMismatch&&((D=t.changePasswordForm.get("confirmPassword"))!=null&&D.touched)?59:-1),a(2),m("disabled",t.isSubmitting),a(3),m("disabled",t.changePasswordForm.invalid||t.isSubmitting),a(),f(t.isSubmitting?65:66),a(2),w(" ",t.isSubmitting?"Cambiando...":"Cambiar contrase\xF1a"," ")}},dependencies:[S,J,Y,R,q,G,B,X,j],styles:['.security-notice[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fef3c7,#fde68a);border:1px solid #f59e0b;border-radius:12px;padding:20px;margin-bottom:32px}.security-notice[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:flex-start;gap:16px}@media (max-width: 479px){.security-notice[_ngcontent-%COMP%]{padding:16px;margin-bottom:24px;flex-direction:column;gap:12px}}.security-notice__icon[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:50%;background:#f59e0b33;color:#c57f08;flex-shrink:0;display:flex;align-items:center;justify-content:center}@media (max-width: 479px){.security-notice__icon[_ngcontent-%COMP%]{width:40px;height:40px}.security-notice__icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:20px}}.security-notice__icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:24px}.security-notice__content[_ngcontent-%COMP%]{flex:1}.security-notice__title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#634004;margin:0 0 12px}@media (max-width: 479px){.security-notice__title[_ngcontent-%COMP%]{font-size:14px;margin-bottom:8px}}.security-notice__list[_ngcontent-%COMP%]{margin:0;padding-left:20px;color:#945f06}.security-notice__list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:14px;margin-bottom:4px}@media (max-width: 479px){.security-notice__list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:13px}}.security-notice__list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{margin-bottom:0}.form-field__label[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:500;color:#1f2937;margin-bottom:8px}@media (max-width: 479px){.form-field__label[_ngcontent-%COMP%]{font-size:13px;margin-bottom:6px}}.form-field__required[_ngcontent-%COMP%]{color:#ef4444;margin-left:4px}.form-field__input-container[_ngcontent-%COMP%]{position:relative}.form-field__input[_ngcontent-%COMP%]{width:100%;padding:12px 48px 12px 16px;border:2px solid #e5e7eb;border-radius:10px;font-size:14px;background:#fff;transition:all .2s ease}.form-field__input[_ngcontent-%COMP%]:focus{outline:none;border-color:#f59e0b;box-shadow:0 0 0 3px #f59e0b1a}.form-field__input.ng-invalid.ng-touched[_ngcontent-%COMP%]{border-color:#ef4444;box-shadow:0 0 0 3px #ef44441a}@media (max-width: 479px){.form-field__input[_ngcontent-%COMP%]{padding:14px 48px 14px 16px;font-size:16px}}.form-field__toggle-password[_ngcontent-%COMP%]{position:absolute;right:16px;top:50%;background:none;border:none;color:#9ca3af;cursor:pointer;padding:4px;border-radius:4px;transition:color .2s ease;transform:translateY(-50%)}.form-field__toggle-password[_ngcontent-%COMP%]:hover{color:#6b7280}.form-field__toggle-password[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px}.form-field__error[_ngcontent-%COMP%]{margin-top:6px;font-size:12px;color:#ef4444;font-weight:500}.form-field__error[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-start;gap:6px}@media (max-width: 479px){.form-field__error[_ngcontent-%COMP%]{font-size:11px}}.form-field__error[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:12px;color:#ef4444}@media (max-width: 479px){.form-field__error[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:11px}}.password-strength[_ngcontent-%COMP%]{margin-top:12px}.password-strength__label[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;margin-bottom:8px;font-weight:500}.password-strength__bar[_ngcontent-%COMP%]{height:4px;background:#e5e7eb;border-radius:2px;overflow:hidden;margin-bottom:6px}.password-strength__fill[_ngcontent-%COMP%]{height:100%;border-radius:2px;transition:all .2s ease}.password-strength__fill--weak[_ngcontent-%COMP%]{background:linear-gradient(90deg,#ef4444,#eb1515)}.password-strength__fill--fair[_ngcontent-%COMP%]{background:linear-gradient(90deg,#f59e0b,#c57f08)}.password-strength__fill--good[_ngcontent-%COMP%]{background:linear-gradient(90deg,#3b82f6,#0b63f3)}.password-strength__fill--strong[_ngcontent-%COMP%]{background:linear-gradient(90deg,#10b981,#0c8a60)}.password-strength__text[_ngcontent-%COMP%]{font-size:11px;font-weight:600;text-transform:uppercase;letter-spacing:.5px}.password-strength__text--weak[_ngcontent-%COMP%]{color:#ef4444}.password-strength__text--fair[_ngcontent-%COMP%]{color:#f59e0b}.password-strength__text--good[_ngcontent-%COMP%]{color:#3b82f6}.password-strength__text--strong[_ngcontent-%COMP%]{color:#10b981}@media (prefers-reduced-motion: reduce){.form-field__input[_ngcontent-%COMP%], .form-field__toggle-password[_ngcontent-%COMP%], .password-strength__fill[_ngcontent-%COMP%]{transition:none!important}.form-field__input[_ngcontent-%COMP%]:hover, .form-field__toggle-password[_ngcontent-%COMP%]:hover, .password-strength__fill[_ngcontent-%COMP%]:hover{transform:none!important}}[_ngcontent-%COMP%]:focus-visible{outline:3px solid #f59e0b;outline-offset:2px;border-radius:4px}.change-password-form[_ngcontent-%COMP%]{max-width:600px;margin:0 auto;padding:24px}.change-password-form__header[_ngcontent-%COMP%]{text-align:center;margin-bottom:32px;padding-bottom:24px;border-bottom:1px solid #e5e7eb}@media (max-width: 479px){.change-password-form__header[_ngcontent-%COMP%]{margin-bottom:24px;padding-bottom:16px}}.change-password-form__title[_ngcontent-%COMP%]{font-size:28px;font-weight:700;color:#1f2937;margin:0 0 12px}.change-password-form__title[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:12px}@media (max-width: 479px){.change-password-form__title[_ngcontent-%COMP%]{font-size:24px;margin-bottom:8px}}.change-password-form__title-icon[_ngcontent-%COMP%]{font-size:32px;color:#f59e0b}@media (max-width: 479px){.change-password-form__title-icon[_ngcontent-%COMP%]{font-size:28px}}.change-password-form__description[_ngcontent-%COMP%]{font-size:16px;color:#6b7280;line-height:1.5;margin:0}@media (max-width: 479px){.change-password-form__description[_ngcontent-%COMP%]{font-size:14px}}.change-password-form__form[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:32px;box-shadow:0 4px 24px #00000014;border:1px solid #e5e7eb}@media (max-width: 479px){.change-password-form__form[_ngcontent-%COMP%]{padding:20px;border-radius:12px}}.change-password-form__fields[_ngcontent-%COMP%]{display:grid;gap:24px;margin-bottom:40px}@media (max-width: 479px){.change-password-form__fields[_ngcontent-%COMP%]{gap:20px;margin-bottom:32px}}.change-password-form__actions[_ngcontent-%COMP%]{padding-top:32px;border-top:1px solid #f3f4f6}.change-password-form__actions[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end;gap:16px}@media (max-width: 479px){.change-password-form__actions[_ngcontent-%COMP%]{padding-top:24px;flex-direction:column;gap:12px}.change-password-form__actions[_ngcontent-%COMP%]   .change-password-form__button[_ngcontent-%COMP%]{width:100%}}.change-password-form__button[_ngcontent-%COMP%]{padding:12px 24px;border-radius:10px;font-weight:600;font-size:14px;cursor:pointer;border:none;min-width:160px;transition:all .3s cubic-bezier(.4,0,.2,1)}.change-password-form__button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:8px}@media (max-width: 479px){.change-password-form__button[_ngcontent-%COMP%]{padding:14px 20px;font-size:16px}}.change-password-form__button[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none!important}.change-password-form__button--primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f59e0b,#c57f08);color:#fff;box-shadow:0 4px 14px #f59e0b40}.change-password-form__button--primary[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 8px 24px #f59e0b59}@media (prefers-reduced-motion: reduce){.change-password-form__button--primary[_ngcontent-%COMP%]:hover:not(:disabled){transform:none}}.change-password-form__button--primary[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(0)}.change-password-form__button--secondary[_ngcontent-%COMP%]{background:transparent;color:#6b7280;border:2px solid #e5e7eb}.change-password-form__button--secondary[_ngcontent-%COMP%]:hover:not(:disabled){background:#f9fafb;color:#1f2937;border-color:#d1d5db}@media (hover: none) and (pointer: coarse){.change-password-form__button--secondary[_ngcontent-%COMP%]:hover:not(:disabled){background:transparent;color:#6b7280;border-color:#e5e7eb}}.form-field__help[_ngcontent-%COMP%]{margin-top:12px;text-align:right}@media (max-width: 479px){.form-field__help[_ngcontent-%COMP%]{text-align:left;margin-top:8px}}.forgot-password-link[_ngcontent-%COMP%]{background:none;border:none;color:#3b82f6;font-size:13px;font-weight:500;cursor:pointer;padding:6px 12px;border-radius:8px;transition:all .25s cubic-bezier(.4,0,.2,1);text-decoration:none;position:relative}.forgot-password-link[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:8px}.forgot-password-link[_ngcontent-%COMP%]:hover:not(:disabled){background:#3b82f614;color:#0b5fe9;transform:translateY(-1px)}.forgot-password-link[_ngcontent-%COMP%]:hover:not(:disabled):after{transform:scaleX(1)}@media (hover: none) and (pointer: coarse){.forgot-password-link[_ngcontent-%COMP%]:hover:not(:disabled){background:none;color:#3b82f6;transform:none}}@media (prefers-reduced-motion: reduce){.forgot-password-link[_ngcontent-%COMP%]:hover:not(:disabled){transform:none}}.forgot-password-link[_ngcontent-%COMP%]:focus{outline:2px solid rgba(59,130,246,.4);outline-offset:3px;background:#3b82f60f}.forgot-password-link[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(0);background:#3b82f61f}@media (prefers-reduced-motion: reduce){.forgot-password-link[_ngcontent-%COMP%]:active:not(:disabled){transform:none}}.forgot-password-link[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.forgot-password-link[_ngcontent-%COMP%]:disabled:hover{background:none;transform:none;color:#3b82f6}.forgot-password-link[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:4px;left:12px;right:12px;height:1px;background:currentColor;transform:scaleX(0);transform-origin:center;transition:transform .25s cubic-bezier(.4,0,.2,1)}.forgot-password-link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:11px;opacity:.85;flex-shrink:0}.forgot-password-link[_ngcontent-%COMP%]   .fa-spinner[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1.2s linear infinite}@media (max-width: 479px){.forgot-password-link[_ngcontent-%COMP%]{font-size:14px;padding:8px 16px}.forgot-password-link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:12px}}.forgot-password-link--subtle[_ngcontent-%COMP%]{color:#6b7280;font-size:12px}.forgot-password-link--subtle[_ngcontent-%COMP%]:hover:not(:disabled){color:#3b82f6}@media (max-width: 479px){.forgot-password-link--subtle[_ngcontent-%COMP%]{font-size:13px}}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.form-field__input[_ngcontent-%COMP%]:focus + .form-field__toggle-password[_ngcontent-%COMP%]{color:#3b82f6}.change-password-form__form[_ngcontent-%COMP%]   .forgot-password-link[_ngcontent-%COMP%]{margin-top:2px}']})};var Q=class r{passwordService=c(P);logger=c(b);notificationService=c(E);router=c(F);destroy$=new M;isSubmitting=!1;ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}handlePasswordChange(n){this.isSubmitting=!0,this.logger.info("Iniciando cambio de contrase\xF1a"),this.passwordService.changePassword(n.currentPassword,n.newPassword).pipe(O(this.destroy$),U(()=>this.isSubmitting=!1)).subscribe({next:e=>{this.logger.info("Contrase\xF1a cambiada exitosamente",e),this.notificationService.success("\xA1Contrase\xF1a cambiada con \xE9xito!",{duration:7e3,action:{label:"Cerrar",action:()=>this.notificationService.dismissAll()}}),setTimeout(()=>{this.router.navigate(["/user-panel/profile"])},2e3)},error:e=>{this.logger.error("Error al cambiar contrase\xF1a:",e);let t=e instanceof Error?e.message:"Error al cambiar la contrase\xF1a. Verifica tu contrase\xF1a actual e int\xE9ntalo nuevamente.";this.notificationService.error(t,{duration:7e3,action:{label:"Cerrar",action:()=>this.notificationService.dismissAll()}})}})}handleCancel(){this.router.navigate(["/user-panel/profile"])}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=y({type:r,selectors:[["app-change-password"]],decls:2,vars:1,consts:[[1,"change-password-container"],[3,"formSubmit","formCancel","isSubmitting"]],template:function(e,t){e&1&&(o(0,"div",0)(1,"app-change-password-form",1),g("formSubmit",function(p){return t.handlePasswordChange(p)})("formCancel",function(){return t.handleCancel()}),i()()),e&2&&(a(),m("isSubmitting",t.isSubmitting))},dependencies:[S,z],styles:[".change-password-container[_ngcontent-%COMP%]{max-width:600px;margin:0 auto;padding:24px}@media (max-width: 479px){.change-password-container[_ngcontent-%COMP%]{padding:16px}}"]})};export{Q as ChangePasswordContainer};
