import{a as l}from"./chunk-VO6ML35U.js";import{a as S}from"./chunk-R25INWIT.js";import{a as p,b as u}from"./chunk-YOZKJIIB.js";import{a as h}from"./chunk-ZGRDZCQA.js";import{B as i,W as n,aa as d,m as o,p as s}from"./chunk-MFDETKI4.js";var v=class c{apiService=d(u);logger=d(p);storage=d(S);getSchedules(){return this.apiService.get(l.GET_ALL).pipe(s(r=>r||[]),i(r=>this.handleError("Failed to fetch schedules",r)))}addSchedule(r){return this.apiService.post(l.ADD,r).pipe(i(e=>this.handleError("Failed to create schedule",e)))}getAvailableDays(r){return this.apiService.get(l.GET_DAYS(r)).pipe(s(e=>!e||!Array.isArray(e.available_days)?{available_days:[]}:{available_days:e.available_days.filter(t=>typeof t.day=="string"&&typeof t.start_time=="string"&&typeof t.end_time=="string"&&/^[a-zA-Z]+$/.test(t.day)&&/^\d{2}:\d{2}:\d{2}$/.test(t.start_time)&&/^\d{2}:\d{2}:\d{2}$/.test(t.end_time))}),i(e=>this.handleError(`Failed to fetch available days for specialty ${r}`,e)))}deleteSchedule(r){return this.apiService.delete(l.DELETE(r)).pipe(i(e=>this.handleError(`Failed to delete schedule ${r}`,e)))}addDoctorToSchedule(r,e){let a=new h().set("doc_id",r).set("schedule_id",e);return this.apiService.put(l.ADD_DOCTOR,{},{params:a}).pipe(i(t=>this.handleError(`Failed to add doctor ${r} to schedule ${e}`,t)))}updateSchedule(r){return this.apiService.put(l.UPDATE,r).pipe(i(e=>this.handleError(`Failed to update schedule ${r.id}`,e)))}handleError(r,e){this.logger.error(r,e);let a="An unexpected error occurred";if(e instanceof Error)a=e.message;else if(typeof e=="object"&&e!==null&&"status"in e){let t=e;switch(t.status){case 400:a=t.error?.detail??"Invalid request data";break;case 401:a=t.error?.detail??"Unauthorized access",this.storage.clearStorage();break;case 403:a=t.error?.detail??"Forbidden action";break;case 404:a=t.error?.detail??"Resource not found";break;default:a=t.error?.detail??"Server error"}}return o(()=>new Error(a))}static \u0275fac=function(e){return new(e||c)};static \u0275prov=n({token:c,factory:c.\u0275fac,providedIn:"root"})};export{v as a};
