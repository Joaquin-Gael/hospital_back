import{d as T}from"./chunk-CPNTZRGK.js";import{a as C}from"./chunk-WQ6RSETU.js";import{a as D,b as x,d as M,e as A}from"./chunk-CY6JAXVF.js";import{a as k}from"./chunk-UJLVOMAY.js";import{r as F}from"./chunk-LILA3PAH.js";import{e as g}from"./chunk-VEGP4YTZ.js";import{$b as p,Jb as i,Kb as l,Ob as v,Qb as u,Rb as m,Sc as y,Yc as I,_a as d,bc as S,db as s,ia as f,ja as h,kb as b,pb as _,yb as c}from"./chunk-VYPP3LKO.js";function j(n,e){if(n&1){let o=v();i(0,"div",3),p(1),i(2,"button",4),u("click",function(){f(o);let a=m();return h(a.error=null)}),i(3,"span",5),p(4,"close"),l()()()}if(n&2){let o=m();d(),S(" ",o.error," ")}}var V=class n{constructor(e,o,r,a){this.dialogRef=e;this.data=o;this.doctorService=r;this.scheduleService=a;this.title=this.data.context==="doctor"?"Asociar Horario a Doctor":"Asociar Doctor a Horario",this.formFields=[{key:"doctorId",label:"Doctor",type:"select",required:!0,validators:[g.required],options:this.data.doctors.filter(t=>t.is_active).map(t=>({value:t.id,label:`${t.first_name} ${t.last_name} (${t.dni})`})),defaultValue:this.data.doctorId||""},{key:"scheduleId",label:"Horario",type:"select",required:!0,validators:[g.required],options:this.data.schedules.map(t=>({value:t.id,label:`${this.getDayLabel(t.day)} ${t.start_time}-${t.end_time}`})),defaultValue:this.data.scheduleId||""}]}loading=!1;error=null;title;formFields=[];getDayLabel(e){return{Sunday:"Domingo",Monday:"Lunes",Tuesday:"Martes",Wednesday:"Mi\xE9rcoles",Thursday:"Jueves",Friday:"Viernes",Saturday:"S\xE1bado"}[e]||e}onSubmit(e){if(this.data.doctorId&&e.doctorId!==this.data.doctorId){this.error="El ID del doctor no coincide con el contexto seleccionado.",this.loading=!1;return}if(this.data.scheduleId&&e.scheduleId!==this.data.scheduleId){this.error="El ID del horario no coincide con el contexto seleccionado.",this.loading=!1;return}this.loading=!0,this.error=null,(this.data.context==="doctor"?this.doctorService.addSchedule(e.doctorId,e.scheduleId):this.scheduleService.addDoctorToSchedule(e.doctorId,e.scheduleId)).subscribe({next:()=>{this.loading=!1,this.dialogRef.close({success:!0})},error:r=>{this.loading=!1,this.error=r.error?.detail||"Error al asociar doctor y horario"}})}onCancel(){this.dialogRef.close()}static \u0275fac=function(o){return new(o||n)(s(D),s(x),s(C),s(k))};static \u0275cmp=b({type:n,selectors:[["app-assign-doctor-schedule"]],decls:4,vars:5,consts:[[1,"assign-dialog"],["class","error-message","role","alert",4,"ngIf"],[3,"formSubmit","formCancel","fields","title","submitLabel","loading"],["role","alert",1,"error-message"],["aria-label","Cerrar mensaje de error",1,"close-button",3,"click"],[1,"material-icons"]],template:function(o,r){o&1&&(i(0,"div",0)(1,"mat-dialog-content"),_(2,j,5,1,"div",1),i(3,"app-entity-form",2),u("formSubmit",function(t){return r.onSubmit(t)})("formCancel",function(){return r.onCancel()}),l()()()),o&2&&(d(2),c("ngIf",r.error),d(),c("fields",r.formFields)("title",r.title)("submitLabel","Asociar")("loading",r.loading))},dependencies:[I,y,T,A,M,F],styles:[".assign-dialog[_ngcontent-%COMP%]{min-width:400px;padding:24px;background-color:#fff;border-radius:8px}h2[_ngcontent-%COMP%]{margin:0 0 24px;font-size:1.5rem;font-weight:500;color:#333;border-bottom:1px solid #e0e0e0;padding-bottom:16px}.error-message[_ngcontent-%COMP%]{background-color:#f44336;background-color:#fde1df;border-left:4px solid #f44336;color:#f99d97;padding:12px 16px;margin-bottom:24px;border-radius:4px;display:flex;align-items:center;justify-content:space-between}.close-button[_ngcontent-%COMP%]{background:none;border:none;color:#f99d97;cursor:pointer;padding:4px;display:flex;align-items:center;justify-content:center;border-radius:50%}.close-button[_ngcontent-%COMP%]:hover{background-color:#0000000d}"]})};export{V as a};
