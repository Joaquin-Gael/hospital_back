import{a as l}from"./chunk-J2GLTX2R.js";import{W as i,aa as a}from"./chunk-VYPP3LKO.js";var E=class s{ACCESS_TOKEN_KEY="access_token";REFRESH_TOKEN_KEY="refresh_token";STORAGE_KEY_EMAIL="rememberEmail";TEMP_RESET_EMAIL_KEY="temp_reset_email";SCOPES_KEY="scopes";logger=a(l);getToken(e){return this.withStorage("local",`getToken(${e})`,t=>t.getItem(e),()=>null)}setToken(e,t){return this.withStorage("local",`setToken(${e})`,o=>(o.setItem(e,t),!0),()=>!1)}removeToken(e){return this.withStorage("local",`removeToken(${e})`,t=>(t.removeItem(e),!0),()=>!1)}getAccessToken(){return this.getToken(this.ACCESS_TOKEN_KEY)}setAccessToken(e){return this.setToken(this.ACCESS_TOKEN_KEY,e)}getRefreshToken(){return this.getToken(this.REFRESH_TOKEN_KEY)}setRefreshToken(e){return this.setToken(this.REFRESH_TOKEN_KEY,e)}removeTokens(){let e=this.removeToken(this.ACCESS_TOKEN_KEY),t=this.removeToken(this.REFRESH_TOKEN_KEY);return e&&t}getRememberEmail(){return this.getItem(this.STORAGE_KEY_EMAIL)}setRememberEmail(e){return this.setItem(this.STORAGE_KEY_EMAIL,e)}removeRememberEmail(){return this.removeItem(this.STORAGE_KEY_EMAIL)}setTempResetEmail(e){return this.withStorage("session",`setTempResetEmail(${e})`,t=>(t.setItem(this.TEMP_RESET_EMAIL_KEY,e),!0),()=>!1)}getTempResetEmail(){return this.withStorage("session","getTempResetEmail()",e=>e.getItem(this.TEMP_RESET_EMAIL_KEY),()=>null)}removeTempResetEmail(){return this.withStorage("session","removeTempResetEmail()",e=>(e.removeItem(this.TEMP_RESET_EMAIL_KEY),!0),()=>!1)}setItem(e,t){return this.setToken(e,t)}getItem(e){return this.getToken(e)}removeItem(e){return this.removeToken(e)}clearStorage(){return[this.removeTokens(),this.removeRememberEmail(),this.removeItem(this.SCOPES_KEY),this.clearAllTempData()].every(Boolean)}clearAllTempData(){return this.removeTempResetEmail()}getStorage(e){return typeof globalThis>"u"?null:(e==="local"?globalThis.localStorage:globalThis.sessionStorage)??null}withStorage(e,t,o,n){try{let r=this.getStorage(e);return r?o(r):(this.logger.warn(`${t}: ${e}Storage is unavailable.`),n())}catch(r){return this.logger.warn(`${t}: Failed to access ${e}Storage.`,r),n()}}static \u0275fac=function(t){return new(t||s)};static \u0275prov=i({token:s,factory:s.\u0275fac,providedIn:"root"})};export{E as a};
