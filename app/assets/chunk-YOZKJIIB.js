import{c as f}from"./chunk-ZGRDZCQA.js";import{$ as b,B as s,O as d,R as n,T as g,W as l,aa as h,h as c,m as o,p,tc as v}from"./chunk-MFDETKI4.js";var m={error:1,warn:2,info:3,debug:4},u=class a{APP_PREFIX="[HOSPITALSDLGAPP]";minLogLevel;constructor(){this.minLogLevel=v()?"debug":"error"}error(r,e){this.log("error",r,e)}warn(r,e){this.log("warn",r,e)}info(r,e){this.log("info",r,e)}debug(r,e){this.log("debug",r,e)}log(r,e,t){if(this.shouldLog(r)){let i=this.formatMessage(r,e);this.outputLog(r,i,t)}}shouldLog(r){return m[r]<=m[this.minLogLevel]}formatMessage(r,e){let t=new Date().toISOString();return`${this.APP_PREFIX} [${r.toUpperCase()}] ${t} - ${e}`}outputLog(r,e,t){switch(r){case"error":console.error(e,t);break;case"warn":console.warn(e,t);break;case"info":console.info(e,t);break;case"debug":console.debug(e,t);break}}static \u0275fac=function(e){return new(e||a)};static \u0275prov=l({token:a,factory:a.\u0275fac,providedIn:"root"})};var L=class a{constructor(r){this.http=r;this.fetchUuid()}baseUrl="http://127.0.0.1:8000";baseWsUrl="ws://127.0.0.1:8000";uuidSubject=new c(1);uuid$=this.uuidSubject.asObservable();uuidLoaded$;logger=h(u);fetchUuid(){this.uuidLoaded$=this.http.get(`${this.baseUrl}/id_prefix_api_secret/`).pipe(g(r=>{this.logger.debug("UUID fetched:",r.id_prefix_api_secret),this.uuidSubject.next(r.id_prefix_api_secret)}),p(r=>r.id_prefix_api_secret),s(r=>(console.error("Error fetching UUID:",r),o(()=>new Error("No se pudo cargar el UUID de la API")))),d(1)),this.uuidLoaded$.subscribe({error:r=>console.error("UUID loading failed:",r)})}buildUrl(r){return this.uuidLoaded$.pipe(p(e=>{let t=r.replace(/^\/+|\/+$/g,"");return`${this.baseUrl}/${e}/${t}`}),s(e=>(console.error("Error building URL:",e),o(()=>e))))}buildWsUrl(r){return this.uuidLoaded$.pipe(p(e=>{let t=r.replace(/^\/+|\/+$/g,"");return`${this.baseWsUrl}/${e}/${t}`}),s(e=>(console.error("Error building WebSocket URL:",e),o(()=>e))))}get(r,e){return this.buildUrl(r).pipe(n(t=>this.http.get(t,e)),s(t=>(console.error(`Error in GET ${r}:`,t),o(()=>new Error(`Error al obtener datos de ${r}`)))))}post(r,e,t){return this.buildUrl(r).pipe(n(i=>this.http.post(i,e,t)),s(i=>(console.error(`Error in POST ${r}:`,i),o(()=>new Error(`Error al enviar datos a ${r}`)))))}put(r,e,t){return this.buildUrl(r).pipe(n(i=>this.http.put(i,e,t)),s(i=>(console.error(`Error in PUT ${r}:`,i),o(()=>new Error(`Error al actualizar datos en ${r}`)))))}delete(r,e){return this.buildUrl(r).pipe(n(t=>this.http.delete(t,e)),s(t=>(console.error(`Error in DELETE ${r}:`,t),o(()=>new Error(`Error al eliminar datos en ${r}`)))))}patch(r,e,t){return this.buildUrl(r).pipe(n(i=>this.http.patch(i,e,t)),s(i=>(console.error(`Error in PATCH ${r}:`,i),o(()=>new Error(`Error al modificar datos en ${r}`)))))}static \u0275fac=function(e){return new(e||a)(b(f))};static \u0275prov=l({token:a,factory:a.\u0275fac,providedIn:"root"})};export{u as a,L as b};
